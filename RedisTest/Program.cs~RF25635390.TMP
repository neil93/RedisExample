using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Security.Permissions;
using System.Text;
using System.Threading.Tasks;
using StackExchange.Redis;

namespace RedisTest
{
    class Program
    {
        static void Main(string[] args)
        {

            var redis = new RedisConnectionFactory().GetRedisInstance;

            IDatabase db = redis.GetDatabase(1);


            string value = "test:neil";
            db.StringSet("TEST:STRING", "test");




            string v = db.StringGet("neil");
            Console.WriteLine(v); // writes: "abcdefg"


            var hashEntry = new HashEntry[3];
            hashEntry[0] = new HashEntry("Name","neil");
            hashEntry[1] = new HashEntry("Id","001");
            hashEntry[2] = new HashEntry("Gender","male");

            db.HashSetAsync("TEST:HASH",hashEntry);


            db.KeyExpireAsync("TEST:HASH:NEIL", DateTime.UtcNow.AddMonths(3));


            var hash = db.HashValues("TEST:HASH");
            Console.WriteLine(hash[1]);
            



            for (int i = 0; i < 10; i++)
            {
                db.ListLeftPush("TEST:LIST", i);
            }



            //for (int i = 0; i < 20; i++)
            //{
            //    Console.WriteLine(db.ListLeftPop("TEST:LIST"));

            //}


            
            db.SetAdd("TEST:SET", "NEIL2");
            
            //Console.WriteLine(db.SetPop("TEST:SET"));

            db.SortedSetAdd("TEST:SORTED", "test", 9);


            //pub/sub
            //ISubscriber sub = redis.GetSubscriber();
            //sub.Subscribe("message", (channel, message) =>
            //{
            //    Console.WriteLine((string)message);
            //});

            //sub.Publish("message", "Hello World");




            var hashEntity = db.HashGetAll("TEST:HASH");
            Console.WriteLine(hashEntity[0]);
            



            Console.ReadLine();


        }
    }
}
